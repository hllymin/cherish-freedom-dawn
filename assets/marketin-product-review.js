!function(){"use strict";var e,t={207:function(e,t,i){var s;!function(e){e.IMAGE="1",e.VIDEO="2"}(s||(s={}));const r="anonymous";var n=i(353),o=i.n(n);function l(e,t){return`\n  <mkt-review-list-item>\n    <div class="avatar">\n      ${r=e.avatar,!r||t?'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g fill-rule="evenodd" fill="none"><circle r="8" cy="8" cx="8" fill="#ACB8B8" data-follow-fill="#ACB8B8"/><path stroke="#E9EDEE" d="M12.773 12.29a4.8 4.8 0 0 0-9.555.09" data-follow-stroke="#E9EDEE"/><circle r="3.2" cy="6" cx="8" fill="#ACB8B8" stroke="#E9EDEE" data-follow-fill="#ACB8B8" data-follow-stroke="#E9EDEE"/></g></svg>':`<img src="${r}" loading="lazy" />`}\n    </div>\n  <div class="name">\n    ${s=e.author,s?t?1==s.length?`${s}****`:`${s[0]}****${s[s.length-1]}`:s:"****"}\n  </div>\n  <div class="review">\n    <div class="review-info">\n      <div>\n        <mkt-rate rate="${e.rating}"></mkt-rate>\n      </div>\n      <div class="center">\n        ${i=e.from,2==i?'<p class="review-source">From Amazon</p>\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n        <g fill-rule="nonzero" fill="none">\n          <path fill="#1F2329" d="M8 0a8 8 0 1 0 .001 16.001A8 8 0 0 0 8 0Z" />\n          <path\n            fill="#FFF"\n            d="M8.105 3.036c.38 0 .725.046 1.032.137.308.093.556.206.74.341.184.134.337.288.462.46.123.17.21.33.257.476.049.146.072.28.072.407v3.26c0 .113.025.231.077.353.051.121.112.228.182.321.07.093.14.177.214.255.073.077.136.138.19.177l.073.06-1.295 1.24a19.778 19.778 0 0 1-.78-.74l-.11-.112a1.116 1.116 0 0 1-.142-.182c-.145.218-.33.407-.556.568a2.38 2.38 0 0 1-.726.352 3.416 3.416 0 0 1-.799.127 2.06 2.06 0 0 1-.784-.116 2.43 2.43 0 0 1-.67-.363 1.587 1.587 0 0 1-.474-.625 2.182 2.182 0 0 1-.177-.9c0-.31.054-.595.159-.852.107-.259.243-.473.41-.644.169-.172.37-.325.608-.46.237-.133.471-.238.7-.315.228-.075.475-.14.74-.191.267-.052.494-.086.683-.102.19-.016.379-.029.568-.036V5.23c0-.242-.041-.42-.12-.538-.128-.195-.359-.293-.69-.293-.024 0-.054.002-.095.006-.04.003-.118.026-.23.066a1.418 1.418 0 0 0-.32.162 1.564 1.564 0 0 0-.322.329 1.847 1.847 0 0 0-.273.532l-1.679-.15c0-.222.043-.441.125-.66.084-.217.211-.426.382-.624.172-.2.377-.375.617-.525.239-.152.528-.271.864-.363a4.152 4.152 0 0 1 1.087-.135Zm.654 3.918a4.11 4.11 0 0 0-.634.066c-.198.037-.4.1-.607.185a1.13 1.13 0 0 0-.497.393 1.072 1.072 0 0 0-.185.634c0 .318.134.563.4.736a.92.92 0 0 0 .793.121c.32-.093.535-.32.65-.68.053-.166.08-.352.08-.559v-.896Z"\n          />\n          <path\n            fill="#F1941D"\n            d="M3.17 10.512c.025.002.046.011.066.025.73.433 1.301.738 1.712.918 1.48.65 3 .816 4.56.499a10.363 10.363 0 0 0 2.23-.747.249.249 0 0 1 .148-.016c.04.01.062.043.062.096 0 .05-.028.113-.085.183-.05.059-.134.139-.252.24-.118.102-.3.227-.545.377-.245.15-.514.286-.804.41-.29.123-.648.23-1.073.32-.423.092-.86.137-1.309.137-.453 0-.905-.058-1.359-.172a6.103 6.103 0 0 1-1.192-.423 7.953 7.953 0 0 1-.984-.575 7.608 7.608 0 0 1-.757-.58 5.477 5.477 0 0 1-.48-.484.242.242 0 0 1-.056-.091c-.007-.027-.006-.05.005-.066a.127.127 0 0 1 .047-.04.133.133 0 0 1 .066-.01Zm9.316-.08c.235.022.38.066.434.132.04.063.044.191.012.388a2.557 2.557 0 0 1-.162.568c-.129.305-.291.535-.484.685-.065.052-.115.068-.149.05-.033-.018-.033-.062 0-.132.08-.166.165-.39.254-.673.09-.282.102-.464.038-.545a.206.206 0 0 0-.09-.064.597.597 0 0 0-.153-.034c-.063-.007-.12-.01-.168-.014a1.838 1.838 0 0 0-.2 0l-.076.003-.105.008a15.613 15.613 0 0 1-.305.026.912.912 0 0 1-.136.015l-.048.005-.04.004h-.056l-.018-.004-.01-.009-.01-.016c-.023-.059.066-.132.268-.221.202-.09.398-.145.588-.166.175-.027.38-.027.616-.006Z"\n          />\n        </g>\n      </svg>':""}\n      </div>\n      <p>${o()(e.create_at).format("YYYY-MM-DD")}</p>\n    </div>\n    <p class="review-title">\n      ${e.title||""}\n    </p>\n    <p class="review-desc">\n      ${e.content||""}\n    </p>\n    <div class="review-img">\n      ${e.images?e.images.map((e=>`\n          <div>\n            <img src="${e}" loading="lazy"/>\n          </div>`)).join(""):""}\n      ${e.videos?e.videos.map((e=>`\n          <div>\n            <video src="${e}"></video>\n            <div class="media-video">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><g fill-rule="nonzero" fill="none"><rect rx="2" height="20" width="20" opacity=".5" fill="#1F2329"/><path d="M12.548 10.788V9.211c0-.158.05-.34.12-.415l1.663-1.777c.543-.582 1.169-.745 1.169-.122v6.206c0 .623-.626.46-1.17-.121l-1.661-1.778c-.07-.074-.12-.257-.12-.416Zm-.785 1.751c0 .528-.412.956-.92.956H4.42c-.508 0-.92-.428-.92-.956v-5.08c0-.528.412-.956.92-.956h6.422c.509 0 .92.428.92.956v5.08Z" fill="#FFF"/></g></svg>\n            </div>\n          </div>`)).join(""):""}\n    </div>\n  </div>\n  </mkt-review-list-item>\n  \n  `;var i,s,r}var a=i(829),c=i(595);function d(e,t){var i;const s=null===(i=document.querySelector("mkt-review"))||void 0===i?void 0:i.getAttribute("data-avatar"),n=e.map((e=>l(e,s==r))).join("");t.innerHTML=n}const u=e=>("string"==typeof e?e:e.type).includes("image");function h(e,t=0){const i=document.querySelector("mkt-swiper .swiper"),s=document.querySelector("mkt-swiper .swiper-overlay"),r=e.map((e=>function(e){return`\n  <div class="swiper-slide">\n    <div class="review-media-container">\n      ${1==e.type?`<img src="${e.url}">`:`<video src="${e.url}" controls></video>`}\n    </div>\n  </div>\n  \n  `}(e))).join(""),n=i.querySelector(".swiper-wrapper");n&&(n.innerHTML=r),requestAnimationFrame((()=>{const e=i.querySelectorAll(".swiper-slide").item(t).querySelector("video");e&&(e.muted=!0,e.autoplay=!0),i.style.setProperty("display","block"),s.style.setProperty("display","block");const r=new c.Ay(".swiper",{initialSlide:t,pagination:{el:".swiper-pagination",type:"custom",renderCustom:function(e,t,i){return t+"/"+i}},keyboard:{enabled:!0},on:{click(e,t){const o=t.target.tagName;["IMG","DIV"].includes(o)&&matchMedia("screen and (max-width: 750px)").matches&&(i.style.setProperty("display","none"),s.style.setProperty("display","none"),r.destroy(),window.removeEventListener("keyup",n))}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),n=e=>{27==e.keyCode&&(i.style.setProperty("display","none"),s.style.setProperty("display","none"),r.destroy(),window.removeEventListener("keyup",n))};window.addEventListener("keyup",n)}))}const v=window.mktReview&&window.mktReview.shopDomain?window.mktReview.shopDomain:location.host,p=new class{constructor(){var e;this.page=1,this.currentCount=10,this.query=new URLSearchParams({domain:v,page:1,page_size:10,product_id:null===(e=window.meta)||void 0===e?void 0:e.product.id})}load(){return fetch(`https://midas.marketin.cn/shopify-webhook/review/list?${this.query.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{const t=e.data.total;this.currentCount+=e.data.list.length;const i=document.querySelector("mkt-review-list-load-more");return 0==t||this.currentCount>=t?i.style.setProperty("display","none"):i.style.setProperty("display","flex"),e}))}loadMore(){return this.query.set("page",String(++this.page)),this.load().then((e=>e.data.list))}reload(){return this.page=1,this.currentCount=0,this.query.set("page","1"),this.load().then((e=>e.data))}sort(e,t){this.page=1;const i={date:"publish_time",rating:"star_value",photo:"image"}[e];return i?(this.query.set("sort_by",i),this.query.set("sort_dir",t||"")):(this.query.delete("sort_dir"),this.query.delete("sort_by")),this.reload().then((e=>e.list))}filter(e){return this.page=1,e?this.query.set("rating",e):this.query.delete("rating"),this.reload().then((e=>e.list))}},m=new class{submit(e,t,i){var s;const r={domain:v,product_id:null===(s=window.meta)||void 0===s?void 0:s.product.id,images:t,videos:i};for(const[t,i]of e)r[t]=i;return fetch("https://midas.marketin.cn/shopify-webhook/review/save",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(r)}).then((e=>200==e.status?Promise.resolve():Promise.reject()))}uploadMedia(e){const t=new FormData;let i=0;for(t.append("domain",v);i<e.length;){const s=e.item(i);s&&t.append("file",s),i++}return fetch("https://midas.marketin.cn/shopify-webhook/review/upload",{method:"POST",body:t}).then((e=>e.json())).then((e=>e.data))}uploadAsset(e){const t=function(e){const t=(0,a.A)(),i=e.type.split("/").pop();return`${o()(Date.now()).format("YYYY-MM-DD")}-${t}.${"quicktime"==i?"mov":i}`}(e);return fetch("https://shopify.marketin.cn/presigned",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({filename:t,contentType:e.type})}).then((e=>e.json())).then((i=>{const s=new FormData;return Object.keys(i.fields).forEach((e=>{s.append(e,i.fields[e])})),s.append("file",e),new Promise(((r,n)=>{let o=new XMLHttpRequest;o.open("post",i.url),o.send(s),o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<300?r({url:`https://review-assets.marketin.cn/${t}`,contentType:e.type}):n())}}))}))}};customElements.define("mkt-review-sort",class extends HTMLElement{constructor(){super(),this.showList=!1,this.currentSort="";const e=this.querySelector("#sort-btn"),t=this.querySelector(".sort-list"),i=document.createElement("div");i.classList.add("sort-overlay"),i.style.setProperty("display","none"),i.addEventListener("click",(()=>{this.showList=!1,i.style.setProperty("display","none"),null==t||t.style.setProperty("display","none")})),this.append(i),null==e||e.addEventListener("click",(()=>{console.log(this.showList),this.showList?(i.style.setProperty("display","none"),null==t||t.style.setProperty("display","none")):(i.style.setProperty("display","block"),null==t||t.style.setProperty("display","flex")),this.showList=!this.showList})),t.querySelectorAll(".list-item").forEach(((s,r)=>{s.addEventListener("click",(()=>{t.querySelectorAll(".list-item").forEach((e=>{e.classList.remove("active")})),e.textContent=s.textContent,s.classList.toggle("active"),null==t||t.style.setProperty("display","none"),i.style.setProperty("display","none"),this.showList=!1,this.reload(s.getAttribute("data-sort-key")||"",s.getAttribute("data-sort-dir"))}))}))}connectedCallback(){const e=getComputedStyle(this).getPropertyValue("--mkt_review_icon_color");e&&this.style.setProperty("--border-color",e+"33")}reload(e,t){p.sort(e,t).then((e=>{var t;d(e,null===(t=this.parentElement)||void 0===t?void 0:t.querySelector("mkt-review-list"))}))}}),customElements.define("mkt-review-header",class extends HTMLElement{constructor(){super()}}),customElements.define("mkt-review-list-item",class extends HTMLElement{constructor(){super(),this.urls=[],this.querySelectorAll(".review-img > div").forEach(((e,t)=>{var i,s;(null==e?void 0:e.querySelector("img"))?this.urls.push({url:null===(i=null==e?void 0:e.querySelector("img"))||void 0===i?void 0:i.src,type:1}):this.urls.push({url:null===(s=null==e?void 0:e.querySelector("video"))||void 0===s?void 0:s.src,type:2}),e.addEventListener("click",(()=>{h(this.urls,t),console.log(this.urls,t)}))}))}}),customElements.define("mkt-review-list-load-more",class extends HTMLElement{constructor(){super(),this.loading=!1;const e=this.querySelector("button");null==e||e.addEventListener("click",this.loadMore.bind(this))}loadMore(){this.loading||(this.toggleLoading(!0),p.loadMore().then((e=>{var t;!function(e,t){var i;const s=null===(i=document.querySelector("mkt-review"))||void 0===i?void 0:i.getAttribute("data-avatar"),n=e.map((e=>l(e,s==r))).join(""),o=document.createDocumentFragment(),a=document.createElement("div");a.innerHTML=n,o.appendChild(a),t.append(o)}(e,null===(t=this.parentElement)||void 0===t?void 0:t.querySelector("mkt-review-list"))})).finally((()=>{this.toggleLoading(!1)})))}toggleLoading(e){var t;this.loading=e,null===(t=this.querySelector("button"))||void 0===t||t.classList.toggle("loading",e)}}),customElements.define("mkt-rate",class extends HTMLElement{constructor(){super(),this.formMode=!1,this.formMode=this.hasAttribute("form");const e=Number(this.getAttribute("rate"));this.render(e),this.formMode&&(this.classList.add("form"),this.querySelectorAll("svg").forEach(((e,t)=>{e.addEventListener("click",(()=>{this.select(t)}))})))}select(e){this.setAttribute("rate",(e+1).toString()),this.rerender(e)}rerender(e){this.querySelectorAll("svg path[stroke-width]").forEach(((t,i)=>{i<=e?(t.classList.add("active"),t.classList.remove("follow-fill")):(t.classList.remove("active"),t.classList.add("follow-fill"))}))}render(e){const t=Array(5).fill(!1).map(((t,i)=>i<e));this.innerHTML=t.map((e=>`\n  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n  <g fill-rule="evenodd" fill="none">\n    <path d="M0 0h24v24H0z" />\n    <path\n      stroke-width="1.2"\n      class="${e?"active":"follow-fill"}"\n      d="M11.538 2.162c.287-.06.36-.04.422-.001a.399.399 0 0 1 .148.16l3.001 6.051 6.698.977a.4.4 0 0 1 .282.608l-4.932 4.845 1.16 6.63a.4.4 0 0 1-.499.455l-6.07-3.224-5.982 3.19a.4.4 0 0 1-.588-.332l1.17-6.72-4.879-4.769a.4.4 0 0 1 .13-.658l6.827-1 2.965-6.05a.4.4 0 0 1 .147-.162Z"\n      data-follow-stroke="#1F2329"\n    />\n  </g>\n  </svg>\n  `)).join("")}});class y extends HTMLElement{constructor(){var e;super(),this.sId=(null===(e=this.closest("mkt-review"))||void 0===e?void 0:e.getAttribute("section-id"))||"",this.iconColor=getComputedStyle(this).getPropertyValue("--mkt_review_icon_color")}}customElements.define("mkt-progress",class extends y{constructor(){super(),this.selected=!1,window.addEventListener("toggle",(e=>{e.detail==this||this.classList.remove("active")})),this.addEventListener("click",(()=>{var e,t,i;if(this.classList.contains("active"))return this.classList.toggle("active"),null===(e=this.parentElement)||void 0===e||e.classList.remove("focus"),void this.filter(this.getAttribute("rate"));this.classList.toggle("active"),null===(t=this.parentElement)||void 0===t||t.classList.add("focus"),window.dispatchEvent(new CustomEvent("toggle",{detail:this})),this.filter(null===(i=this.querySelector("mkt-rate"))||void 0===i?void 0:i.getAttribute("rate"))}))}filter(e){p.filter(e).then((e=>{var t;d(e,null===(t=this.closest("mkt-review"))||void 0===t?void 0:t.querySelector("mkt-review-list"))}))}}),customElements.define("mkt-write-review",class extends y{constructor(){var e;super(),null===(e=this.querySelector("button"))||void 0===e||e.addEventListener("click",(()=>{window.dispatchEvent(new CustomEvent("writeReview",{detail:this.sId}))}))}});const w={content:e=>({status:Boolean(e),error:e?"":"Content is required"}),author:e=>({status:Boolean(e),error:e?"":"Name is required"}),email:e=>e?/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(e)?{status:!0,error:""}:{status:!1,error:"Invalid Email Address"}:{status:!1,error:"Email is required"}};customElements.define("mkt-write-review-form",class extends y{constructor(){var e,t,i,s,r;super(),this.write=!1,this.style.setProperty("--bg-color",this.iconColor+"10"),window.addEventListener("writeReview",(e=>{e.detail!=this.sId||this.write||(this.initFormStatus(),this.style.setProperty("display","block"),this.write=!0,window.scrollTo({top:this.offsetTop-80,behavior:"smooth"}))})),this.form=this.querySelector("form"),this.submit=this.querySelector('button[type="submit"]'),this.cancel=this.querySelector('button:not([type="submit"])'),null===(e=this.querySelectorAll("input, textarea"))||void 0===e||e.forEach((e=>{e.addEventListener("input",(e=>{const t=e.target;this.checkFormInput(t.name,t.value)}))})),null===(t=this.querySelector('[name="title"]'))||void 0===t||t.addEventListener("input",(e=>{const t=e.target.value;e.target.parentElement.querySelector(".total").innerHTML=`${t.length}/500`})),null===(i=this.querySelector('[name="content"]'))||void 0===i||i.addEventListener("input",(e=>{const t=e.target.value;e.target.parentElement.querySelector(".total").innerHTML=`${t.length}/5000`})),null===(s=this.querySelector('[name="author"]'))||void 0===s||s.addEventListener("input",(e=>{const t=e.target.value;e.target.parentElement.querySelector(".total").innerHTML=`${t.length}/50`})),this.submit.addEventListener("click",(()=>{var e;const t=new FormData(this.form),i=this.checkForm(t),s=[],r=[];if(null===(e=this.form.querySelectorAll("mkt-media-preview"))||void 0===e||e.forEach((e=>{"1"===e.getAttribute("data-type")?s.push(e.getAttribute("data-url")||""):r.push(e.getAttribute("data-url")||"")})),i)return;const n=this.getRequestBody(t);console.log(n),m.submit(n,s,r).then((()=>{this.changeSubmitResult(),this.write=!1,window.dispatchEvent(new CustomEvent("submitSuccess"))})).catch((e=>{console.log(e)}))})),this.cancel.addEventListener("click",this.closeEditReview.bind(this)),null===(r=this.querySelector(".close"))||void 0===r||r.addEventListener("click",this.closeEditReview.bind(this))}checkFormInput(e,t){var i;const s=t||this.form.querySelector(`[name="${e}"]`).value;if(Object.keys(w).includes(e)){const t=w[e];if(t){const{status:r,error:n}=t(s),o=this.querySelector(`[name="${e}"]`),l=null===(i=o.closest("div"))||void 0===i?void 0:i.querySelector(".error");if(!r)return o.classList.add("invalid"),l.innerHTML=n,!0;o.classList.remove("invalid"),l.innerHTML=""}}}checkForm(e){let t=!1;for(const[i,s]of e)this.checkFormInput(i,s)&&(t=!0);return t}getRequestBody(e){var t;const i=(null===(t=this.form.querySelector("mkt-rate"))||void 0===t?void 0:t.getAttribute("rate"))||"1";return e.append("rating",Number(i)),e}changeSubmitResult(){this.querySelector(".form-submit-result").style.setProperty("display","flex"),this.querySelector(".form-container").style.setProperty("display","none"),window.scrollTo({top:this.offsetTop-80,behavior:"smooth"})}closeEditReview(){this.write=!1,this.style.setProperty("display","none")}initFormStatus(){this.form.querySelectorAll(".error").forEach((e=>{e.innerHTML=""})),this.form.querySelectorAll("input,textarea").forEach((e=>{e.value="",e.classList.remove("invalid")})),this.form.querySelectorAll("mkt-media-preview").forEach((e=>{e.remove()})),this.querySelector(".write-review-title .total")&&(this.querySelector(".write-review-title .total").innerHTML="0/500"),this.querySelector(".write-review-content .total")&&(this.querySelector(".write-review-content .total").innerHTML="0/5000"),this.querySelector(".form-submit-result").style.setProperty("display","none"),this.querySelector(".form-container").style.setProperty("display","block"),this.querySelector("mkt-rate").select(4),window.dispatchEvent(new CustomEvent("initForm",{detail:this.sId}))}}),customElements.define("mkt-media-preview",class extends y{constructor(){super()}connectedCallback(){var e,t,i,r;this.dataUrl=this.getAttribute("data-url"),this.dataType=this.getAttribute("data-type");const n=(o=this.dataUrl,this.dataType===s.IMAGE?`\n      <img src="${o}"/>\n      <div class="close">\n        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n          <g fill="none" fill-rule="evenodd">\n            <path\n              d="m13.5 12 6.5 6.5-1.5 1.5-6.5-6.5L5.5 20 4 18.5l6.5-6.5L4 5.5 5.5 4l6.5 6.5L18.5 4 20 5.5z"\n              fill="#fff"\n            />\n          </g>\n        </svg>\n      </div>\n    `:`\n      <video src="${o}"></video>\n      <div class="close">\n        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n          <g fill="none" fill-rule="evenodd">\n            <path\n              d="m13.5 12 6.5 6.5-1.5 1.5-6.5-6.5L5.5 20 4 18.5l6.5-6.5L4 5.5 5.5 4l6.5 6.5L18.5 4 20 5.5z"\n              fill="#fff"\n            />\n          </g>\n        </svg>\n      </div>\n      <div class="media-video">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><g fill-rule="nonzero" fill="none"><rect rx="2" height="20" width="20" opacity=".5" fill="#1F2329"/><path d="M12.548 10.788V9.211c0-.158.05-.34.12-.415l1.663-1.777c.543-.582 1.169-.745 1.169-.122v6.206c0 .623-.626.46-1.17-.121l-1.661-1.778c-.07-.074-.12-.257-.12-.416Zm-.785 1.751c0 .528-.412.956-.92.956H4.42c-.508 0-.92-.428-.92-.956v-5.08c0-.528.412-.956.92-.956h6.422c.509 0 .92.428.92.956v5.08Z" fill="#FFF"/></g></svg>\n      </div>\n    `);var o;this.innerHTML=n,null===(e=this.querySelector(".close"))||void 0===e||e.addEventListener("click",(()=>{var e;null===(e=this.parentElement)||void 0===e||e.removeChild(this),window.dispatchEvent(new CustomEvent("deleteImage",{detail:this.sId}))})),null===(t=this.querySelector("img"))||void 0===t||t.addEventListener("click",(()=>{this.openPreview()})),null===(i=this.querySelector("video"))||void 0===i||i.addEventListener("click",(()=>{this.openPreview()})),this.sId=(null===(r=this.closest("mkt-review"))||void 0===r?void 0:r.getAttribute("section-id"))||""}openPreview(){var e;const t=[];let i=0;null===(e=this.parentElement)||void 0===e||e.querySelectorAll("mkt-media-preview").forEach(((e,s)=>{e==this&&(i=s),t.push({url:e.getAttribute("data-url"),type:e.getAttribute("data-type")})})),h(t,i)}}),customElements.define("mkt-upload-media",class extends y{constructor(){var e;super(),this.count=0,this.loading=!1,this.images=[],this.videos=[];const t=this.querySelector("input");null===(e=this.querySelector(".upload"))||void 0===e||e.addEventListener("click",(()=>{null==t||t.click()})),null==t||t.addEventListener("change",(e=>{const i=e.target.files,s=this.count+i.length;if(s>10)return void this.showError("file count limit 10");this.showError("");const r=this.checkAllFile(i);if(r)return void this.showError(r);const n=[];for(let e=0;e<i.length;e++)n.push(m.uploadAsset(i.item(e)));this.count=s,this.toggleInputStatus(!0),Promise.all(n).then((e=>{console.log(this.count,10),this.count>=10&&this.style.setProperty("display","none"),e.forEach((e=>{this.showPreview(e)}))})).catch((e=>{this.showError("file upload fail, please try again")})).finally((()=>{this.toggleInputStatus(!1),t.value=""}))})),window.addEventListener("deleteImage",(e=>{e.detail==this.sId&&(this.count--,this.style.setProperty("display","block"))})),window.addEventListener("initForm",(e=>{e.detail==this.sId&&(this.count=0,this.style.setProperty("display","block"))}))}toggleInputStatus(e){var t,i;e?(null===(t=this.querySelector("input"))||void 0===t||t.setAttribute("disabled","disabled"),this.querySelector(".add").style.setProperty("display","none"),this.querySelector(".loading").style.setProperty("display","block")):(null===(i=this.querySelector("input"))||void 0===i||i.removeAttribute("disabled"),this.querySelector(".add").style.setProperty("display","block"),this.querySelector(".loading").style.setProperty("display","none"))}checkAllFile(e){let t=0;for(;t<e.length;){const i=this.getCheckFileSize(e[t]);if(i)return i;t++}}showError(e){var t;const i=null===(t=this.closest(".write-review-upload"))||void 0===t?void 0:t.querySelector(".error");i&&(i.innerHTML=e)}showPreview(e){var t;const i=document.createElement("mkt-media-preview");i.setAttribute("data-url",e.url),i.setAttribute("data-type",u(e.contentType)?s.IMAGE:s.VIDEO),null===(t=this.parentElement)||void 0===t||t.insertBefore(i,this)}getCheckFileSize(e){const t=e.size/1024/1024;return u(e)?t>5?`${e.name}- File size limit 5M exceeded ${t.toFixed(2)}M`:null:(e=>("string"==typeof e?e:e.type).includes("video"))(e)?t>20?`${e.name}- File size limit 20M exceeded ${t.toFixed(2)}M`:null:""}}),customElements.define("mkt-swiper",class extends HTMLElement{constructor(){var e;super(),null===(e=this.querySelector(".swiper-button-close svg"))||void 0===e||e.addEventListener("click",(()=>{this.querySelector(".swiper").style.setProperty("display","none"),this.querySelector(".swiper-overlay").style.setProperty("display","none")}))}}),i(332);class g extends HTMLElement{constructor(){super()}}customElements.define("mkt-review",g)}},i={};function s(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={exports:{}};return t[e].call(n.exports,n,n.exports,s),n.exports}s.m=t,e=[],s.O=function(t,i,r,n){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],r=e[d][1],n=e[d][2];for(var l=!0,a=0;a<i.length;a++)(!1&n||o>=n)&&Object.keys(s.O).every((function(e){return s.O[e](i[a])}))?i.splice(a--,1):(l=!1,n<o&&(o=n));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[i,r,n]},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={521:0};s.O.j=function(t){return 0===e[t]};var t=function(t,i){var r,n,o=i[0],l=i[1],a=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in l)s.o(l,r)&&(s.m[r]=l[r]);if(a)var d=a(s)}for(t&&t(i);c<o.length;c++)n=o[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(d)},i=self.webpackChunkaplus=self.webpackChunkaplus||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var r=s.O(void 0,[361],(function(){return s(207)}));r=s.O(r)}();